<?xml version="1.0" encoding="utf-8"?>
<boundary:SMBoundary xmlns:fx="http://ns.adobe.com/mxml/2009" 
					 xmlns:s="library://ns.adobe.com/flex/spark" 
					 xmlns:mx="library://ns.adobe.com/flex/mx" 
					 xmlns:boundary="org.samchon.simulation.simulation.abstract.boundary.*" 
					 xmlns:filetree="org.samchon.simulation.simulation.abstract.filetree.*" 
					 xmlns:ui="org.samchon.ui.*">
	<fx:Declarations>
		<!-- Place non-visual elements (e.g., services, value objects) here -->
	</fx:Declarations>
	<fx:Script>
		<![CDATA[
			import mx.events.FlexEvent;
			import mx.events.ListEvent;
			
			import org.samchon.fileTree.file.FTFile;
			import org.samchon.fileTree.file.FTFileList;
			import org.samchon.fileTree.file.FTFolder;
			import org.samchon.socket.HTTPService;
			
			[Bindable]protected var fileList:FTFileList;
			protected var file:FTFile = null;
			
			override protected function get category():int	{	return Root.category + Category.BOUNDARY_PROGRAMMING;	}
			
			override protected function creationCompleted(event:FlexEvent):void
			{
				super.creationCompleted(event);
				
				fileList = new FTFileList(application, category);
				fileList.load();
				
				fileTreeManager.addEventListener(ListEvent.ITEM_DOUBLE_CLICK, handleFileDoubleClicked);
				fileTreeManager.content = baseScript;
				fileTreeManager.extension = "as";
			}
			protected function handleFileDoubleClicked(event:ListEvent):void
			{
				goOpenFile(null);
			}
			
			/* ----------------------------------------------------------------
				GO_COMPILE
			---------------------------------------------------------------- */
			override public function goCompile():Boolean
			{
				//GO_COMPILE
				return Compiler.goCompile(contentText.text);
			}
			
			/* ----------------------------------------------------------------
				FILE HANDLER
			---------------------------------------------------------------- */
			protected function get baseScript():String
			{
				return "";
			}
			
			override public function goNewFile(event:MouseEvent):void
			{
				fileTreeManager.goNewFile(event);
			}
			override public function goOpenFile(event:MouseEvent):void
			{
				var folder:FTFolder = fileTreeManager.selectedFile;
				if(folder == null || !(folder is FTFile))
					return;
				
				file = folder as FTFile;
				pathLabel.text = file.getLabel();
				contentText.text = file.getContent()
			}
			override public function goSaveFile(event:MouseEvent):void
			{
				if(file == null || file.getOwner() == "example")
					return;
				
				file.setContent( contentText.text );	
				
				var httpService:HTTPService = new HTTPService(URL.FILETREE_CREATE);
				
				var formData:Object = file.toFormData();
				formData.application = fileList.getApplication();
				formData.category = fileList.getCategory();
				
				httpService.send(formData);
			}
			
		]]>
	</fx:Script>
	<s:Panel id="leftPanel" 
			 title="AS3 File-Tree" 
			 width="300" height="100%">
		<ui:VGroup width="100%" height="100%" 
				   padding="5">
			<filetree:SMFileeTreeManager id="fileTreeManager" 
										 dataProvider="{fileList}"
										 width="100%" height="100%" />
		</ui:VGroup>
	</s:Panel>
	<s:Panel id="rightPanel" 
			 title="Programming Code" 
			 width="100%" height="100%">
		<ui:VGroup width="100%" height="100%" 
				   padding="5">
			<ui:HGroup width="100%">
				<s:Button icon="assets/icons/save16.png" 
						  label="Save File" click="goSaveFile(event)" />
				<s:Label id="pathLabel" 
						 width="100%" />
			</ui:HGroup>
			<s:TextArea id="contentText"
						fontSize="12"
						width="100%" height="100%" />
		</ui:VGroup>
	</s:Panel>
</boundary:SMBoundary>
