<?xml version="1.0" encoding="utf-8"?>
<boundary:SMBoundary xmlns:fx="http://ns.adobe.com/mxml/2009" 
					 xmlns:s="library://ns.adobe.com/flex/spark" 
					 xmlns:mx="library://ns.adobe.com/flex/mx" 
					 xmlns:ui="org.samchon.ui.*" 
					 xmlns:namtree="org.samchon.simulation.simulation.backtesting.boundary.namtree.*"
					 xmlns:boundary="org.samchon.simulation.simulation.abstract.boundary.*"
		  
					 creationComplete="creationCompleted(event)">
	<fx:Declarations>
		<!-- Place non-visual elements (e.g., services, value objects) here -->
	</fx:Declarations>
	<fx:Script>
		<![CDATA[
			import mx.collections.ArrayCollection;
			import mx.events.FlexEvent;
			import mx.managers.PopUpManager;
			
			import org.samchon.fileTree.window.explorer.ExplorerOpenWindow;
			import org.samchon.fileTree.window.explorer.ExplorerSaveWindow;
			import org.samchon.namtree.NTCriteriaGrid;
			import org.samchon.simulation.simulation.backtesting.BTNamTreeAlgorithm;
			import org.samchon.simulation.simulation.backtesting.BTNamTreeAlgorithmLabelList;
			import org.samchon.simulation.simulation.backtesting.boundary.namtree.BTNamTreeMovie;
			
			[Bindable]protected var algorithmList:BTNamTreeAlgorithmLabelList;
			public function get criteriaGridArray():Vector.<NTCriteriaGrid>	{	return namTree.criteriaGridArray;	}
			
			override protected function creationCompleted(event:FlexEvent):void
			{
				// TODO Auto-generated method stub
				super.creationCompleted(event);
				
				algorithmList = new BTNamTreeAlgorithmLabelList(namTree);
				goNewFile(null);
			}
			public function getAlgorithmList():AlgorithmList
			{
				/*var algList:AlgorithmList = new AlgorithmList();
				for(var i:int = 0; i < this.algorithmList.length; i++)
					algList.addItem( new Algorithm( this.algorithmList.at(i).getName() ) );
				
				return algList;*/
				return this.algorithmList;
			}
			
			protected function addAlgorithm(event:MouseEvent):void
			{
				// TODO Auto-generated method stub
				algorithmList.addItem( new BTNamTreeAlgorithm(algorithmList) );
			}
			protected function removeAlgorithm(event:MouseEvent):void
			{
				// TODO Auto-generated method stub
				var idx:int = dataGrid.selectedIndex;
				if(idx == -1)
					return;
				
				algorithmList.removeItemAt(idx);
			}
			
			//FILE MANAGER
			override public function goNewFile(event:MouseEvent):void
			{
				algorithmList.removeAll();
				algorithmList = new BTNamTreeAlgorithmLabelList(this.namTree);
			}
			override public function goOpenFile(event:MouseEvent):void
			{
				var openWindow:ExplorerOpenWindow = PopUpManager.createPopUp(Root.window, ExplorerOpenWindow, true) as ExplorerOpenWindow;
				openWindow.parentObject = algorithmList;
				openWindow.application = Root.application;
				openWindow.category = Root.category + 30;
				
				PopUpManager.centerPopUp( openWindow );
			}
			override public function goSaveFile(event:MouseEvent):void
			{
				var saveWindow:ExplorerSaveWindow = PopUpManager.createPopUp(Root.window, ExplorerSaveWindow, true) as ExplorerSaveWindow;
				saveWindow.application = Root.application;
				saveWindow.category = Root.category + 30;
				saveWindow.content = algorithmList.toXML();
				
				PopUpManager.centerPopUp( saveWindow );
			}
			
			//GO_COMPILE
			override public function goCompile():Boolean
			{
				return namTree.goCompile();
			}
			
		]]>
	</fx:Script>
	
	<s:Panel width="300" height="100%" 
			 title="Algorithm List">
		<ui:VGroup width="100%" height="100%" 
				   padding="5">
			<mx:DataGrid id="dataGrid" 
						 dataProvider="{algorithmList}"
						 editable="true" sortableColumns="false"
						 width="100%" height="100%">
				<mx:columns>
					<mx:DataGridColumn headerText="no" dataField="$no" 
									   editable="false"
									   width="50" />
					<mx:DataGridColumn headerText="name" dataField="$name" />
				</mx:columns>
			</mx:DataGrid>
			<s:HGroup width="100%" horizontalAlign="right">
				<s:Button icon="assets/icons/plus16.png" 
						  label="Add Algirhtm" 
						  click="addAlgorithm(event)" />
				<s:Button icon="assets/icons/trash16.png" 
						  label="Delete Algorithm" 
						  click="removeAlgorithm(event)" />
			</s:HGroup>
		</ui:VGroup>
	</s:Panel>
	<namtree:BTNamTreeMovie id="namTree"
							width="100%" height="100%" />
</boundary:SMBoundary>
